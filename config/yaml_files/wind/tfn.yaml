model:
  model_key: tfn
  equivar_pred: true
  comparison_model_num_layers: 2
  node_embedding_dim: 16
  # TFN-specific
  tfn_max_ell: 2
  tfn_mlp_dim: 128
  tfn_unbiased_vector_pred_head: true
  tfn_radial_mode: gaussian
  tfn_radial_mlp_hidden: [128, 128]
  tfn_radial_mlp_activation: swish
  # Lifted 3D wind vectors have components roughly in [-16, 16], so ||v_i - v_j|| can be ~55.4.
  # For TFN's gaussian radial mode, `tfn_r_max` is a *hard cutoff* (weights are set to 0 for r >= r_max).
  # The RBF decay scale inside the cutoff is controlled by `gaussian_eps`, wired from:
  #   dataset.local_pca_distance_kernel_scale
  # Setting r_max=64.0 therefore avoids hard-truncating any wind-space neighbor edges.
  tfn_r_max: 64.0

  # These only apply if tfn_radial_mode is 'bessel_cutoff'
  # tfn_num_bessel: 8
  # tfn_num_polynomial_cutoff: 6

dataset:
  # Gaussian decay scale (eps) used inside TFN's radial kernel ('radial_kernel_gaussian_eps' parameter):
  #   w(r) = exp(-r^2 / eps) for r < r_max, else 0
  # We choose eps so that w(55) \approx 0.1: eps = 55^2 / |ln(0.1)| â‰ˆ 1313.7.
  local_pca_distance_kernel_scale: 1000.0
